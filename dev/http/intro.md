# HTTP 协议简介

## 概述

HTTP 是 Web 服务（也就是网页浏览）的数据传输协议。

它的全名是 HyperText Transfer Protocol（超文本传输协议），其中的 HyperText 指的就是网页。早期的网页包含了各种链接，所以被称为“超文本”。

这个协议原来只是用来传输文本数据，但是现在不仅传输文本数据，也传输二进制数据。

## 版本

1990年，发布 HTTP/0.9。

1996年5月，发布 HTTP/1.0，协议的标准由 RFC1945 规定。

1997年1月，发布 HTTP/1.1，协议的标准由 RFC2616 规定。

2015年5月，发布 HTTP/2，协议的标准由 RFC7540 规定。

2018年8月，发布 HTTP/3，协议的标准由 RFC9114 规定。

## 总体设计

HTTP 协议规定，客户端和服务器都通过发送 HTTP 数据进行通信。

客户端首先发出 HTTP 请求（request），服务器收到以后，发出 HTTP 回应（response）。客户端收到回应以后，再决定下一步的动作。

HTTP 请求和 HTTP 回应，都采用相同的数据格式，由数据头（header）和数据体（data）两部分组成。数据头和数据体之间，使用一个空行分隔。

HTTP 数据里面的换行，都是由回车符（CR，0x0d）+ 换行符（LF, 0X0a）组成。

HTTP 是一个没有状态的协议。也就是说，客户端连续向服务器发两个请求，服务器不会记得前一个请求的内容。所以，所有的状态信息每一次通信都必须发送，不能因为前一次发送过了，这一次就省略了。

这样的设计是为了减轻服务器的负担，便于处理大量请求。

### HTTP 请求

HTTP 请求（request）是客户端向服务器发出的一个要求。下面是一个示例。

```http
GET / HTTP/1.1
Host: example.com
```

上面示例中，第一行由三部分组成。

（1）`GET`：请求的方法（method）。除了`GET`，其他的常见方法还有`POST`、`PUT`和`DELETE`。

（2）`\`：请求针对的路径，这个例子是请求根路径。

（3）`HTTP/1.1`：请求使用的 HTTP 协议版本。

第二行是一个键值对，键名`HOST`表示请求针对的服务器，这个例子是`example.com`。

上面两行合并成为一行，也是可以的。

```http
GET http://example.com/ HTTP/1.1
```

上面示例中，服务器网址写到了第一行，所以就不需要`Host`字段了。

实际应用中，HTTP 请求的数据头还会有许多其他的键值对。每个键值对，单独占据一行。

`GET`方法的请求，不需要数据体，所以这个例子的 HTTP 请求，只有数据头，没有数据体。

### HTTP 回应

HTTP 回应（response）是服务器对收到的请求的一个回答。下面是一个示例。

```http
HTTP/1.1 200 OK
Date: Tue, 13 Jul 2021 06:50:15 GMT
Content-Length: 362
Content-Type: text/html

<html>
……
```

上面示例包括数据头和数据体两部分。

数据头的第一行分成三部分。

（1）`HTTP/1.1`表示 HTTP 协议版本。

（2）`200`是回应的状态码（status code），表示回应的状态。它是一个三位数字，`200`表示处理成功，客户端可以通过这个数字，判断请求是否成功。

（3）`OK`是状态说明，属于对状态码的进一步解释，它是可选的。`200`状态码的文字说明，一般都是`OK`。

第二行开始，是数据头的各种键值对，每个键值对占据一行。

- `Date`：回应的时间。
- `Content-Length`：HTTP 回应数据体的长度（单位字节）。
- `Content-Type`：数据体类型，`text/html`：数据体是 HTML 网页。

数据头结束以后，就是一个空行。空行之后，就是数据体`<html>...`，这就是浏览器收到回应以后，展示的具体内容。

## 备用

HTTP/1.x 是一种纯文本协议，描述客户端和服务器之间的通信。客户端发送这样的消息：

```http
POST /anything/chat HTTP/1.1
host: httpbingo.org
content-type: application/json
user-agent: curl/7.87.0

{
    "message": "Hello!"
}
```

并收到这样的响应消息：

```http
HTTP/1.1 200 OK
date: Mon, 28 Aug 2023 07:51:49 GMT
content-type: application/json

{
    "message": "Hi!"
}
```

HTTP/2 是一种二进制协议。不过，所有工具都以纯文本形式显示HTTP/2消息。
