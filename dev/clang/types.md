# 数据类型

C 语言的数据分为以下类型，都是基本数据类型，复杂的类型都是基于它们构建的。

## 整数类型

C 语言的整数类型（integer types）又分成8种子类型。它们的行为都很类似，主要差异是数据的长度，即多少个比特位（bits）储存，越大的整数需要的比特位越多。

- char：长度为 8 个比特位，也就是一个字节。整数的表示范围为-128到127（有符号的整数）或0到255（无符号的整数）。
- short：小整数，长度为16个比特位，整数表示范围为-32768到32767（有符号的整数）。
- int：正常整数，这是整数的默认子类型，长度一般为32比特位。
- long：大整数，长度至少是32比特位（4个字节），表示范围为-20亿到20亿。

上面这四种类型，前面都可以加上`unsigned`关键字，字节长度不变，表示无负号的整数。

- unsigned char
- unsigned short
- unsigned int
- unsigned long

## 字符常量

放在单引号里面的单个字符，被 C 语言视为字符常量。以下都是字符常量。

- 'A'：大写的字母 A。
- '\n'：换行符。
- '\t'：制表符。
- '\0'：null 字符，代表没有内容。注意，这个不代表数字0，是当作字符解读。
- '\012'：代表八进制的12，相当于十进制的10。

## 整数常量

C 语言编译器读到数字时（比如`123`），默认会把数字当作整数类型（`int`）。

如果数字加上`L`后缀（比如`123L`，大小写都可），则会把数字解析为长整数类型（`long int`）。

## 整数的进制

整数常量不仅可以是十进制，也可以是其他进制（比如八进制和十六进制）。

八进制使用`0`作为前缀，比如`017`、`0377`。

十六进制使用`0x`作为前缀，比如`0xf`、`0xff`。

## 编译器的自动类型判断

对于整数常量，编译器会自动将它处理为`int`类型。如果常量的值太大，无法放入`int`，就用`long int`类型。如果还是太大，则使用`unsigned long int`类型。

如果想让编译器直接将整数常量作为长整数处理，只需在后面加上一个字母`L`或`l`。比如，`15L`、`0377L`、`0x7fffL`。

为了指明是无符号常量，可以在常量后面加上字母`U`或`u`。比如，`15U`、`0377U`。

`L`和`U`可以结合使用，表示常量既是长整型又是无符号的。比如`0xfffffffUL`。（字母`L`和`U`的顺序和大小写无所谓。）

字母`LL`或`ll`，表示整数常量是`long long int`类型。

对于浮点数，编译器默认以双精度储存。如果要以单精度储存，浮点数常量的后面要添加`F`或`f`。如果要以`long double`储存，要添加`L`或`l`。

## 浮点数

浮点数主要用来表示小数，内部采用跟整数不一样的格式。

C 语言提供三种浮点数类型。

- float：单精度浮点数，提供6位精度，通常是32位（4个字节）。
- double：双精度浮点数，提供15位精度，通常是64位（8个字节）。
- long double：字节宽度更大的浮点数。

C 语言编译器自动将小数（比如`3.14`）当作双精度浮点数。如果想把小数指定为其他类型，需要在小数后面添加后缀`f`（float）或`l`（long double）。

这里需要注意，浮点数的计算是不精确的。

## 字符

字符的类型是`char`。

```c
char ch;

ch = 'a';
```

字符类型本质是0到127的整数。

## 布尔值

C 语言没有布尔值类型，`0`被当成`false`，所有非零值被当成`true`。

```c
i = 0;
while (i - 10) {
// ...
```

上面代码中，只要`i - 10`不等于`0`，C 语言就认为判断为真，从而执行循环体。

## 类型的自动转换

当不同类型的数据互相运算时，宽度较小的类型会转换到与另一个运算子相同宽度。

## 变量的截值（Truncation）

截值（Truncation）指的是将一个值，从较宽的类型变为较窄的类型。多出来的比特位，将被自动截去。

```javascript
char ch;
int i;

i = 321;
ch = i; // ch 的值是 65 （321 - 256）
```

上面例子中，变量`ch`的长度是8个二进制位，只能容纳变量`i`（16个二进制位）的后八位。`321`的二进制形式是`101000001`，保留后八位就变成了`01000001`（十进制的65，相当于字符`A`）。

浮点数赋值给整数类型的值，小数部分会被截去。

```c
double pi;
int i;

pi = 3.14159;
i = pi; // i 的值为 3
```

为了避免这个问题，整数运算时，有时可能需要明确将类型转为浮点数。

```c
int score;
score = 5;

score = (score / 20) * 100;
```

上面的代码，你可能觉得经过运算，`score`会等于`25`，但是实际上`score`等于`0`。这是因为`score / 20`会得到一个整数值，即`0`，所以乘以`100`后得到的也是`0`。

为了得到预想的结果，可以采用下面两种写法，将`score`显式或非显式地转为浮点数。

```c
/* 写法一 */
score = ((double)score / 20) * 100;

/* 写法二 */
score = (score / 20.0) * 100;
```

## struct 命令

`struct`命令用于自定义复杂的数据类型。

```clang
struct fraction {
  int numerator;
  int denominator;
};
```

上面示例定义了一个分数`fraction`的数据类型，其中包含两个属性`numerator`和`denominator`。

注意，`struct`语句结尾的分号不能省略，否则很容易产生错误。

定义好了类型以后，就可以声明变量了。

```clang
struct fraction f1;

f1.numerator = 22;
f1.denominator = 7;
```

声明变量时，自定义的类型名前面，不要忘记加上`struct`关键字。变量的属性通过点（`.`）来表示。

## typedef 命令

`typedef`命令用来为某个类型起别名。

```c
typedef type name;
```

上面代码中，`type`代表某个类型，`name`代表别名。

```c
typedef struct treenode* Tree;
```

上面示例中，`Tree`为`struct treenode*`的别名。

## sizeof 运算符

`sizeof`运算符接受一个变量名作为参数，返回该变量占用的字节数量。

除了`char`类型的变量始终为一个字节，其他类型的变量在不同的系统上，占用的字节数量可能会有所不同。

```c
int a = 999;


sizeof a; // 4
sizeof(2 + 7); // 4
sizeof 3.14; // 8
```

也可以直接对各种类型名使用`sizeof`运算符，这时类型名必须放在括号里面。

```c
sizeof(int); // 4
sizeof(char); // 1
```
