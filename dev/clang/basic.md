# C 语言简介

## 历史

1971年，美国贝尔实验室的 Ken Thompson 与 Dennis Ritchie 一起开发了 Unix 操作系统。Unix 是用汇编语言写的，无法移植到其他计算机，他们决定使用高级语言重写。但是，当时的高级语言无法满足他们的要求，Thompson 先是在 BCPL 语言的基础上发明了 B 语言。1972年，Ritchie 和 Brian Kernighan 又在 B 语言的基础上重新设计了一种新语言，这种新语言取代了 B 语言，所以称为 C 语言。

C 语言主要是为了开发 UNIX 而设计的，后来广泛用于操作系统和系统软件的开发。1988年，美国国家标准协会（ANSI）正式将 C 语言标准化。直到几十年以后的今天，C 语言依然是最广泛使用、最流行的系统编程语言之一，Unix 和 Linux 系统现在还是使用 C 语言开发。

## C 语言的特点

C 语言能够长盛不衰、广泛应用，主要原因是它有一些鲜明的特点。

（1）低级语言

C 语言能够直接操作硬件、管理内存、跟操作系统对话，这使得它是一种非常接近底层的语言，也就是低级语言，适合写需要跟硬件交互的程序。

（2）可移植性

C 语言的原始设计目的，就是将 Unix 系统移植到其他计算机架构。这使得它从一开始就非常注重可移植性，C 语言程序可以相对简单地移植到各种硬件架构和操作系统。

除了计算机，C 语言现在还是嵌入式系统的首选编程语言，汽车、照相机、家用电器等等设备的微芯片都是用 C 语言编程，就是因为它的良好可移植性。

（3）简单性

C 语言的语法相对简单，提供的语法功能并不太多，也几乎没有语法糖。一般来说，如果两个语法可以完成几乎相同的事情，C 语言就只会提供一种。而且，C 语言的语法都是基础语法，不提供高级语法，比如没有“类”（class），复杂的数据结构都需要自己构造。

（4）灵活性

C 语言对程序员的限制很少。它假设程序员知道自己在干嘛，不会限制你做各种危险的操作，你干什么都可以，后果也由自己负责。C 语言的哲学是“信任程序员，不要妨碍他们做事”。比如，它让程序员自己管理内存，不提供内存自动清理功能。另外，也不提供类型检查、数组的负索引检查、指针位置的检查等保护措施。表面上看，这似乎很危险，但是对于高级程序员来说，却有了更大的编程自由。不过，这也使得 C 语言的 debug 不太容易。

（5）总结

上面这些特点，使得 C 语言可以写出性能非常强、完全发挥硬件潜力的程序，而且 C 语言的编译器实现难度相对较低。但是另一方面，C 语言代码容易出错，一般程序员不容易写好。

## C 语言的版本

历史上，C 语言有过多个版本。

（1）K＆R C

`K&R C`指的是 C 语言的原始版本。1978年，C 语言的发明者丹尼斯·里奇（Dennis Ritchie）和布莱恩·克尼根（Brian Kernighan）合写了一本著名的 C 语言教材《C 编程语言》（The C programming language）。由于 C 语言还没有成文的语法标准，这本书就成了公认标准，以两位作者的姓氏首字母命名。

（2）ANSI C（又称 C89 或 C 90）

1989年，美国国家标准协会（ANSI）制定了一套 C 语言标准。1990年，国际标准化组织（ISO）也通过了这个标准。

（3）C95

1995年，美国国家标准协会对 C 语言标准，进行了补充，加入多字节字符和宽字符的支持。

（4）C99

C 语言标准的第一次大型修订，增加了许多语言特性，比如双斜杠（`//`）的注释语法。这是目前最流行的 C 版本。

（5）C11

2011年通过的 C 语言修订版，增加了 Unicode 和多线程的支持。

（6）C17

2017年对 C11 标准进行了修补，但是发布是在2018年。它只是解决了 C11 的一些缺陷，没有引入任何新功能。

（7）C2x

C 语言正在讨论之中的下一个版本，可能会在2021年通过，到时就会改称为 C21。

## C 语言的编译

C 语言是一种编译语言，源码都是文本文件，只有通过编译器（compiler）才能生成二进制的可执行文件。编译器处理代码的过程，就称为编译阶段，简称为“编译时”（compile time）。

目前，最常见的编译器是自由软件基金会推出的 GCC 编译器，它可以免费使用。本书也使用这个编译器。

C 语言的源代码文件，通常以后缀名`.c`结尾。下面是一个简单的 C 程序`hello.c`。它就是一个普通的文本文件，任何文本编译器都能用来写。

```c
# include <stdio.h>

int main(void) {
  printf("Hello World\n");
  return 0;
}
```

上面这个程序的唯一作用，就是在屏幕上面显示“Hello World”，这里不讲解这些代码是什么意思，只是作为一个举例，让大家看看 C 语言编程的流程是什么样的。

有了源码以后，就可以将它编译成二进制可执行文件。这里假设你已经安装好了 GCC 编译器，在 Linux 系统下面可以打开命令行，执行下面的命令。

```bash
$ gcc hello.c
```

上面命令使用`gcc`编译器，将源文件`hello.c`编译成二进制代码。注意，`$`是命令行提示符，你真正需要输入的是`$`后面的部分。

运行这个命令以后，默认会在当前目录下生成一个编译产物文件`a.out`。执行该文件，就会在屏幕上输出`Hello World`。

```bash
$ ./a.out
Hello World
```

GCC 的`-o`参数可以指定编译产物的文件名。

```bash
$ gcc -o hello hello.c
```

上面命令的`-o hello`指定，编译产物的文件名为`hello`。然后，执行`hello`文件，也会得到同样的结果。

```bash
$ ./hello
Hello World
```

## 变量

变量指的是内存的一块特定的区域，可以保存各种类型的值。变量名就是用来引用这块区域的代号。由于保存的值可能发生变化，所以称为变量。如果保存的值不会发生变化，那就是常量。

变量名可以包括字母、数字和下划线，但是不能以数字开头。变量名区分大小写，`x`和`X`是两个不同的变量。

C 语言要求，声明变量时，需要在变量名之前提供变量的类型。

```c
int num;
num = 42;
```

上面代码中，第一行声明了一个变量`num`，变量名之前是它的类型`int`（整数）。第二行给这个变量赋值。

一次声明多个变量也是可以的，类型关键字后面使用逗号，分隔多个变量名。

```c
float x, y, z, X;
```

注意，由于 C 语言不会自动清除内存，如果只声明变量、不进行赋值的话，该变量的值就会是该内存区域原来留存的值。这一点务必需要小心。

## 赋值运算符

赋值运算符`=`用来为变量赋值。

```c
i = 6;
```

注意，赋值运算有返回值，等于等号右边的值。

```c
y = (x = 2 * x)
```

上面代码中，变量`x`先是将自己的值倍增，然后返回这个新的值，赋给变量`y`。
