# C 语言基本语法

## 语句和表达式

C 语言代码由一个个语句（statement）组成，分号是语句终止符，每个语句都必须以分号结尾。

```c
int x = 1;
```

上面代码是一个变量声明语句。

多个语句可以写在一行，一个语句也可以写成多行，所以要依靠分号判断语句是否结束，不能省略。

```c
int x; x = 1;

// 等同于

int x;
x
=
1
;
```

上面示例的两种写法是等价的。编译器会自动忽略代码里面的换行。

语句除了包含各种命令，还包含表达式。表达式（expression）是一个计算式，用来获取某个式子的值。

```c
1 + 2
```

上面代码就是一个表达式，用来获取`1 + 2`这个算术计算的结果。

表达式与语句的区别主要是，表达式都有返回值，语句不一定有。因为语句用来执行某个命令，很多时候不需要返回值，比如变量声明语句（`int x = 1`）就没有返回值。

C 语言允许多个语句使用大括号`{}`，组成一个语法块。

```c
{
  // ...
}
```

## 注释

注释是对代码的说明，编译器会忽略注释。C 语言的注释有两种表示方法。

第一种方法是将注释放在`/* */`之间，内部可以分行。

```c
/* 注释 */

/*
  这是一行注释
*/
```

第二种写法是将注释放在双斜杠`//`后面，从双斜杠到行尾都属于注释。这种注释只能是单行，可以放在行首，也可以放在一行语句的结尾。这是 C99 标准新增的语法。

```c
// 这是一行注释

int x = 1; // 这也是注释
```

只包含空格的行被称为空白行，编译器会完全忽略该行。

## main()

所有的 C 程序，入口文件里面一定要包含一个`main()`函数。程序从这个函数开始运行，也就是说，其他函数最终都是通过它引入程序的。

C 语言规定，定义函数时，要给出类型说明，包括返回值的类型和参数的类型（详见《函数》一章）。`main()`也不例外，定义一般都是下面这个样子。

```c
int main(void) {
  // 函数体
}
```

上面示例中，`int`是返回值的类型说明，表示该函数返回一个整数。`void`是参数类型的说明，表示该函数不需要参数。

下面就是一个`main()`函数的示例。

```c
int main(void) {
  printf("Hello World");
  return 0;
}
```

上面示例中，最后的`return 0;`表示函数结束运行，返回`0`。C 语言约定，返回值`0`表示函数运行成功，如果返回其他非零整数，就表示运行失败，代码出了问题。

正常情况下，如果省略`return 0`这一行，编译器会自动加上。所以，写成下面这样，效果完全一样。

```c
int main(void) {
  printf("Hello World");
}
```

由于 C 语言只会对`main()`函数默认添加返回值，对其他函数不会这样做，所以建议不要采用上面的写法，总是保留`return`语句，以便形成统一的代码风格。

## printf()

### 基本用法

后面的示例会大量用到`printf()`函数，这里先介绍一下这个函数。

`printf()`的作用是将它的参数文本，输出到屏幕。它名字里面的`f`代表`format`（格式化），表示可以定制输出文本的格式。

```c
printf("Hello World");
```

上面命令会在屏幕上输出一行文字“Hello World”。

运行结束后，光标就停留在输出结束的地方，不会自动换行。为了让光标移到下一行的开头，可以在输出文本的结尾，添加一个换行符`\n`。

```c
printf("Hello World\n");
```

`printf()`是在标准库的头文件`stdio.h`定义的。所有使用这个函数的源码文件，都需要在源码文件头部引入这个头文件。

```c
#include <stdio.h>

int main(void) {
  printf("Hello World\n");
}
```

上面示例中，只有在源码头部加上`#include <stdio.h>`，才能使用`printf()`这个函数。`#inclue`指令的详细解释，请看《预处理》一章。

### 占位符

`printf()`可以在输出文本中指定占位符。所谓“占位符”，就是在这个位置上可以用其他值代入。

```c
printf("There are %i apples", 3);
```

上面示例中，`There are %i apples\n`就是输出文本，里面`%i`就是占位符，这个位置是要用其他值来替换的。占位符的第一个字符一律为`%`，第二个字符表示占位符的类型，`%i`表示这里代入的值必须是一个整数。

`printf()`的第二个参数就是代入占位符的值，上面的例子是整数`3`跟`%i`相对应。执行后的输出就是`There are 3 apples`。

占位符`%s`表示代入的是字符串。

```c
printf("%s will come tonight", "Jane");
```

上面示例中，`%s`表示代入的是一个字符串，所以`printf()`的第二个参数就要指定为字符串`Jane`。执行后的输出就是`Jane will come tonight`。

输出文本中可以指定多个占位符。

```c
printf("%s says it is %i o'clock", "Ben", 21);
```

上面示例中，输出文本`%s says it is %i o'clock`有两个占位符，第一个是字符串占位符`%s`，第二个是整数占位符`%i`，分别对应`printf()`的第二个参数（`Ben`）和第三个参数（`21`）。执行后的输出就是`Ben says it is 21 o'clock`。

`printf()`参数与占位符是一一对应关系，如果有`n`个占位符，`printf()`的参数就应该有`n + 1`个。如果参数个数少于对应的占位符，`printf()`可能会输出内存中的任意值。

常用的占位符的类型有以下几种。

- `%d`：十进制整数
- `%i`：整数
- `%f`：小数
- `%hd`：十进制 short 类型（类似的有`%ho`八进制 short 类型，`%hx`八进制 short 类型）
- `%ld`：十进制 long 类型（类似的有`%lo`八进制 long 类型，`%lx`十六进制 long 类型）
- `%lld`：十进制 long long 类型
- `%o`：八进制整数
- `%s`：字符串
- `%u`：unsigned int 类型（类似的有`%lu`表示 unsigned long 类型，`%llu`表示 unsigned long long 类型）
- `%x`：十六进制整数

### 输出格式

`printf()`可以定制占位符的输出格式。举例来说，占位符`%f`输出的是一个小数，如果希望小数点后面只保留两位，占位符可以写成`%.2f`。

```c
// 输出 Number is 0.50
printf("Number is %.2f\n", 0.5);
```

上面示例中，如果希望小数点后面输出3位（`0.500`），占位符就要写成`%.3f`。
