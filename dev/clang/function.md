# 函数

## 简介

函数是一段可以重复执行的代码。它可以接受不同的参数，返回对应的值。

```c
int plus_one(int n) {
    return n + 1;
}
```

上面就是一个函数，声明时首先需要给出返回值的类型，这里是`int`，表示返回一个整数。`plus_one`是函数名，后面括号里面是参数类型和参数名，`int n`表示这个函数有一个整数参数`n`。

```c
static int Twice(int num) {
  int result = num * 2;
  return(result);
}
```

上面示例中，`static`关键字表示该函数只能在当前文件里使用，如果没有这个关键字，其他文件也可以使用这个函数，但是提供原型。`int`表示函数返回值的类型，`Twice`是函数名，`int num`表示函数参数`num`的类型是`int`。函数体内部，`return`命令用来返回值。

注意，函数声明的结尾不需要加分号。

调用函数只要在函数名后面加上括号就可以了，参数放在括号里面，就像下面这样。

```c
int a = Twice(13);
// a 等于 26
```

函数必须声明后使用，否则会报错。

如果函数没有返回值，声明时使用`void`关键字表示类型。

如果函数不使用任何参数，建议在圆括号里面加上`void`。

```c
int foo(void) {
  return 1234;
}
```

下面是两个变量交换值的例子。

```c
void Swap(int* x, int* y){
  int temp;
  temp = *x;
  *x = *y;
  *y = temp;
}

int a = 1;
int b = 2;
Swap(&a, &b);
```

上面示例由于没有返回值，使用`void`关键字表示函数返回类型，并且也没有`return`命令。

## 传值引用

如果函数的参数是一个变量，那么调用时，传入的是这个变量的值的副本，而不是变量本身。

```c
void increment(int a) {
  a++;
}

int main(void) {
  int i = 10;
  increment(i);
}
```

上面示例中，调用`increment(i)`以后，`main`函数里面的`i`不会发生变化，因为在函数`increment`里面递增是`i`的副本。




注意，`Swap`函数的参数传入的是变量指针，而不是变量本身。这是因为 C 语言的函数参数是传值的，即传入的是参数变量的拷贝，而不是参数本身，所以如果写成下面这样，直接传入参数变量本身，是不会生效的。

```c
void Swap(int x, int y) {
  int temp;
  temp = x;
  x = y;
  y = temp;
}

int a = 1;
int b = 2;
Swap(a, b); // 无效
```

上面的写法不会产生交换变量值的效果，因为传入的变量是原始变量`a`和`b`的拷贝，不管函数体怎么操作，都影响不了原始变量。

## const 关键字

`const`关键字表示变量或参数不会改变值。

```c
void foo(const struct fraction* fract);
```

## main() 函数

C 语言规定，`main()`是程序的入口函数，即程序总是先执行`main()`函数。因此，每个程序至少应该有一个`main()`函数。

通常，`main()`返回一个整数值。根据惯例，返回`0`表示程序运行成功，返回非零整数表示程序运行出现了问题。

## 函数原型

如果脚本使用不在当前文件定义的函数，那么需要先给出函数的原型，然后才能使用该函数。

函数原型是返回值的类型 + 函数名 + 参数类型，不包括函数体，最后以分号结尾。

```c
int Twice(int num);
void Swap(int* a, int* b);
```

只要先给出原型，函数就可以先使用、后声明。所以，有些程序员在脚本头部，给出当前脚本使用的所有函数的原型，即使这个函数是在当前脚本定义的也是如此。

```c
int foo(void);

int main(void) {
  int i;
  i = foo();
}

int foo(void) {
  return 3490;
}
```

上面示例中，只要先给出函数`foo()`的原型，就可以先使用这个函数，后给出函数定义。

