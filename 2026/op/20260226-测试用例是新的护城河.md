## 测试是新的护城河

很多人大概都知道，[Next.js](https://nextjs.org) 是目前排名第一的 JS 全栈框架，用户极多。

![](https://cdn.beekka.com/blogimg/asset/202602/bg2026022808.webp)

但是就在上周，这个框架被一则新闻颠覆了。

一个 Cloudflare 工程师[宣布](https://blog.cloudflare.com/vinext/)，他只用了一个星期就用 AI 重新实现了 Next.js[vinext](https://vinext.io/)。

![](https://cdn.beekka.com/blogimg/asset/202602/bg2026022809.webp)

事实上，都不需要一个星期，产品原型一天就有了。

> “真正动手是2月13日，当天晚上，基本功能已经实现。第二天下午，11个路由做好了10个。到了第三天，已经部署到我们的服务器，实现了完整的客户端水合。
>
> 接下来的一周，主要进行安全加固：修复各种极端情况，扩展测试套件，并将 API 覆盖率提升至 94%。”

他重新实现的 Next.js 甚至比原版更好。

> “在早期基准测试中，构建速度提升了4倍，客户端软件包的体积缩小了57%，我们已经有生产环境的 Next.js 应用跑在上面了。” 

他把这个版本的 Next.js 起名为 [vinext](https://github.com/cloudflare/vinext)，代码已经放出来了，大家可以去看。

![](https://cdn.beekka.com/blogimg/asset/202602/bg2026022810.webp)

我觉得，这件事对 Next.js 的打击非常大。

Next.js 是 Vercel 公司的产品，背后有一个大型开发团队，每年都是巨额投入，已经整整做了10年。他们把代码开源，但是企业版、云服务、插件、皮肤要收费，去年的年收入达到2亿美元。

这种看似难以逾越的护城河，在 AI 面前不堪一击。一个工程师一个星期就拿出了替代品，可以直接部署到服务器，现有应用放上去就能跑，原框架的每个功能都支持，花费的 Token 支出仅仅1100美元。

这叫 Vercel 怎么再向 Next.js 的开发投钱，客户又怎么愿意再为某个功能付出高昂的使用费。

所有的商业软件都因此受到打击，因为代码的护城河不存在了，AI 证明了只要投入一小笔金钱，就能复刻大型的软件产品。

为了保护自己，软件公司下一步肯定要防止 AI 复刻。

怎么防呢？关键就是测试用例。

这一次，Cloudflare 工程师能够复刻成功，一大原因就是 Next.js 有完备的文档、详细的社区文章、以及完整的测试用例。AI 生成的代码只要通过测试，就能确认百分百支持原有功能。

如果没有拿到测试用例，谁知道代码行为是否一致，更不敢拿到生产环境运行。

可以想象，为了防止复刻，大型软件项目一定会保护自己的测试用例。测试才是新的护城河。

世界最流行的数据库 [SQLite](https://sqlite.org)，本身代码15.6万行，但是测试用例[9205万行](https://sqlite.org/testing.html)，足足590倍！

这些测试用例，大部分跟代码一起开源，但是最核心的测试套件 [TH3](https://sqlite.org/th3.html) 是闭源的，不公开。

它们主要测试航空、医疗等关键行业的极端情况和边缘案例，属于核心技术资产。正是因为这些保密用例，才让 SQLite 无法复刻。

无独有偶，就在前两天，另一个开源项目 [tldraw](https://github.com/tldraw/tldraw/issues/8082) 也准备将测试用例闭源。

![](https://cdn.beekka.com/blogimg/asset/202602/bg2026022811.webp)

不得不说，封闭的测试用例对于开源项目很不利，但是开发者需要保护自己的利益。在日益强大的 AI 面前，越来越多的软件可能会选择这样做。

---

https://saewitz.com/tests-are-the-new-moat

https://blog.cloudflare.com/vinext/

https://vinext.io/

https://github.com/cloudflare/vinext

SQLite 代码是开源的，但是它的测试套件是闭源的，这导致没人能够复制 SQLite。