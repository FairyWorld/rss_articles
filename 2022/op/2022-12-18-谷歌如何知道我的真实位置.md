## 本周话题：真实方位是如何暴露的？

很多时候，开发者需要知道用户的地理方位。

大家知道，用户上网的 IP 地址可以判断地理方位。我知道你的 IP 地址，就基本知道你来自哪里。

如果不想暴露真实方位，需要使用技术手段，伪装 IP 地址。

但是，这个事情不是那么简单，极可能你还是会暴露。

上周，我看到 Hacker News 论坛上，[有人问](https://news.ycombinator.com/item?id=34032484)，谷歌怎么会知道我在哪里？

他说，我刚从墨西哥回到美国。我在墨西哥时，为了使用美国的银行，就用了 VPN，完全是美国的 IP 地址。

但是回到美国后，我家里的浏览器显示，我的方位还是在墨西哥，看到的广告都是西班牙语。我想不通，谷歌怎么会知道，我的真实位置是在墨西哥？

下面就有人回答。

谷歌判断你的方位，不是看 IP 地址，而是看你的路由器的 MAC 地址。

每个路由器的 MAC 地址都是独一无二的。一般来说，IP 地址可以伪装，但是路由器很难伪装。谷歌的安卓系统和 Chrome 浏览器，都会收集你正在使用的路由器的 MAC 地址，然后调用本机的 GPS，获取你的真实方位。如果机器上没有 GPS，那么就用跟这个 MAC 地址相关的 IP 地址来判断你的方位。

因为确定路由器的这个过程，不是实时的。所以有些时候，你出国了，但是谷歌还会显示以前的方位，要过一段日子以后才会纠正。

所以，在大型互联网公司面前，我们很难真正隐藏自己的方位。

有些外部安卓版本（比如www.GrapheneOS.org）会剥离谷歌服务，或者使用 Chrome 浏览器的社区版 Chromium 以及其他一些不收集数据的浏览器。

问题是很多应用都这么干，只要安装了他们的 App，就在收集路由器的 MAC 地址和 GPS 方位。而且是偷偷做，根本不告诉用户，完全防不胜防。

===

使用这个库 判断 IP 地址。

https://github.com/joeymalvinni/webrtc-ip