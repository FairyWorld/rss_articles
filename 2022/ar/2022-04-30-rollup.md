# rollup.js 使用教程

rollup 的优势就是简单方便，打出的包体积小。

多个脚本文件，打包成一个文件。

安装

```bash
$ npm install --global rollup
```

查看帮助。

```bash
$ rollup --help
```

## 示例

add.js

```javascript
const PI = 3.14;
const E = 2.718;

export function addPi(x) {
  return x + PI;
}

export function addE(x) {
  return x + E; 
}
```

main.js

```javascript
import { addPi } from './add.js';

console.log(addPi(10));
```

然后，使用 rollup 打包。只需要打包`main.js`，rollup 会自动将它的依赖项打包进去。

```bash
$ rollup main.js

const PI = 3.14;

function addPi(x) {
  return x + PI;
}

console.log(addPi(10));
```

默认情况下，rollup 会把打包结果输出到屏幕。可以看到，它把输入语句 import 和输出语句 export 都自动消除了，把 main.js 的依赖项 addpi.js 直接输出成打包结果的一部分。

另外，可以看到 addpi.js 里面的`addE()`没有打包进去，因为没有用到这个函数。插入依赖项时，会自动删除没有用到的代码，这叫做摇树。

如果希望打包成一个自动执行函数，加上`--format iife`参数。

```bash
$ rollup main.js --format iife
```

如果有两个入口文件，就依次填写它们的文件名，会打出两个包（或者更多文件，如果它们有共同的依赖项）。

```bash
$ rollup main1.js main2.js 
```

`--file [FILENAME]`参数将打包结果保存成一个指定文件。

```bash
$ rollup main.js --file bundle.js
```

## 打包 commonJS 模块

它可以将 ES 模块改写成 CommonJS 模块。

```bash
$ rollup add.js --format cjs
```

add.js

```javascript
const PI = 3.14;
const E = 2.718;

function addPi(x) {
  return x + PI;
}

function addE(x) {
  return x + E; 
}

module.exports = { addPi, addE };
```

main.js

```javascript
const { addPi } = require('./add.js');

console.log(addPi(10));
```