## [本周软件] TGFX：2D 图形库

大家有没有想过，计算机（包括手机）软件的图形界面，那些漂亮的组件，是怎么做出来的？

要知道，计算机本质上只是一个计算引擎，**你的程序想要有图形界面，都必须调用图形库**。只有通过图形库，才能获得图形能力。

一般来说，操作系统都自带图形库（包括组件库）。但是，如果软件跨平台，或者要有一些特殊效果，就必须用外部图形库。目前，最流行的通用 2D 图形库是谷歌的 Skia，它是开源的，Chrome 浏览器、Android操作系统和谷歌地图都使用它。

今天，我想给大家介绍**一款国产的开源 2D 图形库，可以作为 Skia 的替代品，它就是来自腾讯的 [TGFX](https://github.com/Tencent/tgfx)**。如果你的软件需要底层图形引擎，可以考虑它。

TGFX 来源于腾讯的[动效解决方案 PAG](https://pag.art/)。现在，很多项目都需要非常强的动画效果（比如游戏、直播礼物、营销活动），而且需要跨平台，腾讯的动效工具团队为了支持这些项目，就自己做了 PAG 这个工具。

PAG 的核心依赖就是底层的图形库，最早用的就是 Skia。但是，用了一阵，发现了两个问题：（1）Skia 为了兼容历史版本，体积较大，性能也比较保守；（2）对于国内开发者看重的问题，Skia 开发团队往往不能或不愿，做出改进和响应。

于是，腾讯的动效工具团队就下定决心，要换掉 Skia，开发自己的图形库。这件事的难度很大，要用 C++ 开发，兼容各种操作系统的底层接口（目前主要是 OpenGL），生成各种各样的图形，还要保证性能和渲染效果。

他们从2021开始做这件事，直到今年才小有所成。

（1）充分利用现代 GPU 的计算能力，保证性能。

（2）提供全面的图形能力，具备完整的图片、矢量和文本的 2D 绘制能力。

（3）实现 Skia 的轻量化平替，包体大小仅仅 400KB，就实现了 2MB 的 Skia 的绝大部分功能。

（4）使用成本低，API 与 Skia 是相同的，并且进行了简化和整合。

PAG 4.0 版本的图形引擎，从 Skia 改成TGFX 以后，包体积降低65%，矢量渲染性能提升 60%。

它已经大量用在国内很多头部项目。据统计，截止2023年7月，借助 PAG 项目，TGFX 已经实际运行在了1000+ 的头部业务场景中。

其中不仅有腾讯的微信，手机 QQ，王者荣耀，也有小红书，知乎，Bilibili等外部项目，稳定性也经过了 10 亿+ 用户设备的持续验证。性能表现也不凡，为腾讯文档带来了 50% 的内存直线降低。

TGFX 最早是作为 PAG 项目的一部分，而开源的。近期才独立出来，变成了一个单独的开源项目，放在 GitHub 上面，欢迎大家试用。进一步的详细介绍，可以参考[官方文档](https://docs.qq.com/doc/DREh2bnFGR2RKc3BV)。